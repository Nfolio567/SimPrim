!function(){"use strict";
/*! SimPrim-Simple Image Trimming Library v1.0.0 | Nfolio | ISC | https://github.com/Nfolio567/SimPrim */"undefined"!=typeof window&&(window.SimPrim=class{constructor(i){this.scaleWidth=0,this.scaleHeight=0,this.resizing=!1,this.dragging=!1,this.isDragging=!1,this.decisionWH=!1,this.isAnimating=!1,this.defaultCursor=!0,this.drawTrimmingWidth=0,this.drawTrimmingHeight=0,this.inputCvs=i,this.inputCtx=this.inputCvs.getContext("2d")}init(i,s,t,h="https://cdn.nfolio.one/trimming.png"){var o;this.img=i;let e=0,n=0;this.cx=0,this.cy=0,this.dx=0,this.dy=0,this.beforeDx=0,this.beforeDy=0,this.inputCvs.width=this.img.width,this.inputCvs.height=this.img.height,this.img.width<=this.img.height?(this.decisionWH=!1,this.inputCvs.style.cssText+="height:"+s+";width:"+t+";"):this.decisionWH=!0,e=this.inputCvs.width,n=this.inputCvs.height,null===(o=this.inputCtx)||void 0===o||o.drawImage(this.img,0,0,this.img.width,this.img.height,0,0,e,n);const d=new Image;d.crossOrigin="anonymous",this.trimming=d,this.decisionWH?(this.drawTrimmingHeight=this.inputCvs.height/3*2,this.drawTrimmingWidth=this.drawTrimmingHeight):(this.drawTrimmingWidth=this.inputCvs.width/3*2,this.drawTrimmingHeight=this.drawTrimmingWidth),this.trimming.onload=()=>{var i;this.trimming&&void 0!==this.dx&&void 0!==this.dy&&(null===(i=this.inputCtx)||void 0===i||i.drawImage(this.trimming,0,0,d.width,d.height,this.dx,this.dy,this.drawTrimmingWidth,this.drawTrimmingHeight))},this.trimming.src=h,this.inputCvs.addEventListener("mousemove",(()=>{this.defaultCursor&&(this.inputCvs.style.cursor="default")})),window.addEventListener("mouseup",(()=>{this.isDragging=!1,this.dragging=!1,this.resizing=!1}))}dragDetection(i){i&&this.previewImg(i),this.inputCvs.addEventListener("mousedown",(()=>{this.isDragging=!0})),this.inputCvs.addEventListener("mousemove",(s=>{this.defaultCursor&&(this.inputCvs.style.cursor="default"),this.scaleWidth=this.inputCvs.width/this.inputCvs.clientWidth,this.scaleHeight=this.inputCvs.height/this.inputCvs.clientHeight,void 0!==this.dx&&(this.cx=this.dx/this.scaleWidth+this.drawTrimmingWidth/this.scaleWidth/2),void 0!==this.dy&&(this.cy=this.dy/this.scaleHeight+this.drawTrimmingHeight/this.scaleHeight/2),void 0!==this.cx&&void 0!==this.cy&&(s.offsetX>=this.cx-10&&s.offsetX<=this.cx+10&&s.offsetY>=this.cy-10&&s.offsetY<=this.cy+10?(this.inputCvs.style.cursor="move",this.defaultCursor=!1,this.isDragging&&(this.dragging=!0,this.isAnimating=!0)):this.defaultCursor=!0),void 0!==i&&this.requestFrame(i,s)}))}requestFrame(i,s){this.isAnimating&&(requestAnimationFrame((()=>{var t,h;this.dragging&&(this.inputCvs.style.cursor="move",void 0!==this.dx&&(this.beforeDx=this.dx),void 0!==this.dy&&(this.beforeDy=this.dy),this.dx=(s.offsetX-this.drawTrimmingWidth/this.scaleWidth/2)*this.scaleWidth,this.dy=(s.offsetY-this.drawTrimmingHeight/this.scaleHeight/2)*this.scaleHeight,this.trimming&&this.img&&(this.dx<=0&&(this.dx=0),this.dy<=0&&(this.dy=0),this.dx+this.drawTrimmingWidth>=this.img.width&&(this.dx=this.img.width-this.drawTrimmingWidth),this.dy+this.drawTrimmingHeight>=this.img.height&&(this.dy=this.img.height-this.drawTrimmingHeight)),this.img&&this.trimming&&void 0!==this.dx&&void 0!==this.dy&&void 0!==this.beforeDx&&void 0!==this.beforeDy&&(null===(t=this.inputCtx)||void 0===t||t.drawImage(this.img,this.beforeDx-1,this.beforeDy-1,this.drawTrimmingWidth+2,this.drawTrimmingHeight+2,this.beforeDx-1,this.beforeDy-1,this.drawTrimmingWidth+2,this.drawTrimmingHeight+2),null===(h=this.inputCtx)||void 0===h||h.drawImage(this.trimming,0,0,this.trimming.width,this.trimming.height,this.dx,this.dy,this.drawTrimmingWidth,this.drawTrimmingHeight))),i&&this.previewImg(i)})),this.dragging||this.resizing||(this.isAnimating=!1))}sizeChange(){let i="",s="",t=0,h=0;function o(o){var e,n,d,v,l;this.resizing&&void 0!==this.dx&&void 0!==this.dy&&((this.drawTrimmingWidth<=0||this.drawTrimmingHeight<=0)&&(this.drawTrimmingHeight=0,this.drawTrimmingWidth=this.drawTrimmingHeight),this.dragging=!1,i=s,this.isAnimating=!0,t=this.drawTrimmingWidth,h=this.drawTrimmingHeight,"downR"==i&&this.img&&(this.inputCvs.style.cursor="nwse-resize",0!=o.movementX&&(this.drawTrimmingWidth+=o.movementX*this.scaleWidth),0!=o.movementY&&(this.drawTrimmingHeight+=o.movementY*this.scaleHeight),0!=o.movementX&&0!=o.movementY&&(this.drawTrimmingWidth+=o.movementX/this.scaleWidth/4*2-o.movementX/this.scaleWidth/2,this.drawTrimmingHeight+=o.movementY/this.scaleHeight/4*2-o.movementX/this.scaleHeight/2),this.drawTrimmingHeight=this.drawTrimmingWidth,this.dx+this.drawTrimmingWidth>=this.img.width&&(this.drawTrimmingWidth=this.img.width-this.dx,this.drawTrimmingHeight=this.drawTrimmingWidth),this.dy+this.drawTrimmingHeight>=this.img.height&&(this.drawTrimmingHeight=this.img.height-this.dy,this.drawTrimmingWidth=this.drawTrimmingHeight),null===(e=this.inputCtx)||void 0===e||e.drawImage(this.img,this.dx-1,this.dy-1,t+2,h+2,this.dx-1,this.dy-1,t+2,h+2)),"upR"==i&&this.img&&(this.beforeDy=this.dy,this.inputCvs.style.cursor="nesw-resize",0!=o.movementX&&(this.dy-=o.movementX*this.scaleWidth,this.drawTrimmingWidth+=o.movementX*this.scaleWidth),this.drawTrimmingHeight=this.drawTrimmingWidth,this.dx+this.drawTrimmingWidth>=this.img.width&&(this.drawTrimmingWidth=this.img.width-this.dx),this.dy<=0&&(this.dy=0,this.drawTrimmingHeight=h,this.drawTrimmingWidth=t),null===(n=this.inputCtx)||void 0===n||n.drawImage(this.img,this.dx-1,this.beforeDy-1,t+2,h+2,this.dx-1,this.beforeDy-1,t+2,h+2)),"downL"==i&&this.img&&(this.beforeDx=this.dx,this.inputCvs.style.cursor="nesw-resize",0!=o.movementX&&(this.dx+=o.movementX*this.scaleWidth,this.drawTrimmingWidth-=o.movementX*this.scaleWidth),this.drawTrimmingHeight=this.drawTrimmingWidth,this.dx<=0&&(this.dx=0,this.drawTrimmingWidth=t,this.drawTrimmingHeight=h),this.dy+this.drawTrimmingHeight>=this.img.height&&(this.drawTrimmingHeight=this.img.height-this.dy,this.drawTrimmingWidth=this.drawTrimmingHeight,this.dx=this.beforeDx),null===(d=this.inputCtx)||void 0===d||d.drawImage(this.img,this.beforeDx-1,this.dy-1,t+2,h+2,this.beforeDx-1,this.dy-1,t+2,h+2)),"upL"==i&&(this.beforeDx=this.dx,this.beforeDy=this.dy,this.inputCvs.style.cursor="nwse-resize",0!=o.movementX&&(this.dx+=o.movementX*this.scaleWidth,this.dy+=o.movementX*this.scaleWidth,this.drawTrimmingWidth-=o.movementX*this.scaleWidth),this.drawTrimmingHeight=this.drawTrimmingWidth,this.dx<=0&&(this.dx=0,this.dy=this.beforeDy,this.drawTrimmingWidth=t,this.drawTrimmingHeight=h),this.dy<=0&&(this.dy=0,this.dx=this.beforeDx,this.drawTrimmingWidth=t,this.drawTrimmingHeight=h),this.img&&(null===(v=this.inputCtx)||void 0===v||v.drawImage(this.img,this.beforeDx-1,this.beforeDy-1,t+2,h+2,this.beforeDx-1,this.beforeDy-1,t+2,h+2))),this.trimming&&(null===(l=this.inputCtx)||void 0===l||l.drawImage(this.trimming,0,0,this.trimming.width,this.trimming.height,this.dx,this.dy,this.drawTrimmingWidth,this.drawTrimmingHeight)))}this.inputCvs.addEventListener("mousemove",(t=>{o.call(this,t),s=i,void 0!==this.dx&&void 0!==this.dy&&(t.offsetX*this.scaleWidth>=this.dx-15&&t.offsetX*this.scaleWidth<=this.dx+15?(t.offsetY*this.scaleHeight>=this.dy-15&&t.offsetY*this.scaleHeight<=this.dy+15?(i="upL",this.resizing||(this.inputCvs.style.cursor="nwse-resize"),this.defaultCursor=!1,this.isDragging&&(this.resizing=!0)):this.defaultCursor=!0,t.offsetY*this.scaleHeight>=this.dy+this.drawTrimmingHeight-15&&t.offsetY*this.scaleHeight<=this.dy+this.drawTrimmingHeight+15?(i="downL",this.resizing||(this.inputCvs.style.cursor="nesw-resize"),this.defaultCursor=!1,this.isDragging&&(this.resizing=!0)):this.defaultCursor=!0):this.defaultCursor=!0,t.offsetX*this.scaleWidth>=this.dx+this.drawTrimmingWidth-15&&t.offsetX*this.scaleWidth<=this.dx+this.drawTrimmingWidth+15?(t.offsetY*this.scaleHeight>=this.dy-15&&t.offsetY*this.scaleHeight<=this.dy+15?(i="upR",this.resizing||(this.inputCvs.style.cursor="nesw-resize"),this.defaultCursor=!1,this.isDragging&&(this.resizing=!0)):this.defaultCursor=!0,t.offsetY*this.scaleHeight>=this.dy+this.drawTrimmingHeight-15&&t.offsetY*this.scaleHeight<=this.dy+this.drawTrimmingHeight+15?(i="downR",this.resizing||(this.inputCvs.style.cursor="nwse-resize"),this.defaultCursor=!1,this.isDragging&&(this.resizing=!0)):this.defaultCursor=!0):this.defaultCursor=!0)}))}previewImg(i){this.previewCvs=i;const s=this.previewCvs.getContext("2d");null==s||s.clearRect(0,0,i.width,i.height),this.img&&void 0!==this.dx&&void 0!==this.dy&&(null==s||s.drawImage(this.img,this.dx,this.dy,this.drawTrimmingWidth,this.drawTrimmingHeight,0,0,i.width,i.height))}exportImg(i){var s;let t=i.getContext("2d"),h=null===(s=this.previewCvs)||void 0===s?void 0:s.toDataURL(),o=new Image;o.onload=()=>{h&&(null==t||t.drawImage(o,0,0))},h&&(o.src=h)}})}();
